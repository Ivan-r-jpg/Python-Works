"""
Перетворіть словник, створений у практичній роботі №5, на датафрейм.
За потреби доповніть словник новими даними (наприклад,
додайте ще кілька записів або стовпців із додатковими характеристиками об’єктів), виведіть вміст словника на екран.
Виконайте базовий аналіз даних:
-Виведіть перші 3 рядки DataFrame (df.head(3)).
-Перевірте типи даних (df.dtypes).
-Визначте кількість рядків і стовпців (df.shape).
-Отримайте описову статистику (df.describe())

Додайте новий стовпець, який буде містити розрахункові значення.
Наприклад, обчисліть загальну вартість продажу товару для кожного запису.
Виконайте фільтрацію даних, наприклад, виберіть товари з ціною понад 10 000 грн.
Виконайте сортування даних, наприклад, за спаданням ціни або кількості.
Виконайте групування даних та знайдіть середнє значення.

Виконайте додаткові операції агрегації
"""

import pandas as pd # Імпортування бібліотеки pandas для роботи з датафреймом

# Запис оригінального словника
student_dict = {
    "Гриценко": 150,
    "Павленко": 178,
    "Лунцевич": 163,
    "Бабакович": 152,
    "Бринькевич": 180,
    "Мельник": 154,
    "Гринькевич": 147,
    "Ждан": 190,
    "Фамільянович": 181,
    "Отрукиотбиванич": 134
}

def print_start_dict(data_dict_arg):
    print("\nПочатковий словник:")
    for key, value in data_dict_arg.items():
        print(f"{key}: {value}")
"""
Функція print_start_dict(data_dict) необхідна для виводу на екран вхідного словника, що використовувався раніше у 5-й лабораторній роботі.
Аргументом функція приймає лише словник.
"""

def create_df(data_dict_arg):
    df_students = pd.DataFrame({
        'Прізвище': list(data_dict_arg.keys()),
        'Ріст (см)': list(data_dict_arg.values())
    })
    print("\nДатафрейм, отриманий зі словника:")
    print(df_students)
    return df_students
"""
Функція create_df(data_dict) необхідна для перетворення словника на датафрейм.
Аргументом функції виступає словник.
Результатом функції є покажчик на створений датафрейм. 
"""

def print_df(df_arg):
    print(df_arg)
"""
Функція print_df(df) необхідна для виводу на екран датафрейму.
Аргументом функції є датафрейм. 
"""

def input_df(df_arg):
    while True:
        print("\n~~ПІДМЕНЮ РЕДАГУВАННЯ:~~\n>2.1< - Додати стовпець 'Вік'\n>2.2< - Додати стовпець 'Вага (кг)'\n>2.3< - Додати розрахуновий стовпець (ІМТ)\n>2.4< - Вивести датафрейм на екран\n>2.0< - Вийти з підменю")
        try:
            choose = input("Введіть ваш вибір: ")
        except ValueError:
            print(">-[УВАГА] - Введіть коректне число!")
            continue

        if choose == '2.1':
            if 'Вік' not in df_arg.columns:
                ages = [10, 11, 10, 10, 12, 11, 10, 12, 11, 9]
                df_arg['Вік'] = ages
                print(">-[УВАГА] - Стовпець 'Вік' успішно додано!")
            else:
                print(">-[УВАГА] - Даний стовпець уже існує у датафреймі!")

        elif choose == '2.2':
            if 'Вага (кг)' not in df_arg.columns:
                weights = [45, 68, 55, 48, 70, 50, 42, 80, 75, 35]
                df_arg['Вага (кг)'] = weights
                print(">-[УВАГА] - Стовпець 'Вага (кг)' успішно додано!")
            else:
                print(">-[УВАГА] - Даний стовпець уже існує у датафреймі!")

        elif choose == '2.3':
            if 'Вік' in df_arg.columns and 'Вага (кг)' in df_arg.columns:
                # Розрахунок ІМТ = Вага / (Ріст (см) / 100)^2
                df_arg['ІМТ'] = (df_arg['Вага (кг)'] / ((df_arg['Ріст (см)'] / 100) ** 2)).round(2)
                print(">-[УВАГА] - Розрахунковий стовпець успішно додано!")
            else:
                print(">-[УВАГА] - Спочатку додайте стовпці 'Вік' та 'Вага (кг)'!")

        elif choose == '2.4':
            print_df(df_arg)

        elif choose == '2.0':
            break
    return df_arg
"""
Функція input_df(df) необхідна для додавання нових стовпців до датафрейму.
У аргументах функції знаходиться датафрейм.
Функція повертає покажчик на оновлений датафрейм як результат.
"""

def analize_df(df_arg):
    print("\nПерші три рядки:")
    print(df_arg.head(3))
    print("\nТипи даних:")
    print(df_arg.dtypes)
    print(f"\nРядків: {df_arg.shape[0]}, стовпців: {df_arg.shape[1]}")
    print("\nОписова статистика:")
    print(df_arg.describe())
"""
Функція analize_df(df) виконує базовий аналіз даних.
Аргументом функції є датафрейм.
"""

def highly(df_arg):
    try:
        height = float(input("Введіть значення росту (см), за яким бажаєте відфільтрувати дітей: "))
        while height < 0:
            height = float(input("Введіть ще раз значення росту, за яким бажаєте відфільтрувати дітей: "))
    except ValueError:
        print(">-[ПОМИЛКА] - Введене некоректне значення!\n(Введіть лише число!)")
    high_students = df_arg[df_arg['Ріст (см)'] > height]
    print(f"\nУчні з ростом понад {height} см:")
    print(high_students)
"""
Функція highly(df) потрібна для фільтрації учнів за ростом.
Наприклад, якщо введено значення для сортування 160 - тоді на екран виведеться датафрейм з учнями, чий ріст більше за 160 см.
Аргументом функції є датафрейм.
"""

def sort(df_arg):
    df_sorted_desc = df_arg.sort_values(by='Ріст (см)', ascending=False)
    print("\nВідсортовано за спаданням росту:")
    print(df_sorted_desc)
"""
Функція sort(df) виконує сортування учнів за зростом у порядку спадання.
Функція приймає аргументом датафрейм.
"""

def group_by_age(df_arg):
    if 'Вік' in df_arg.columns:
        grouped_data = df_arg.groupby('Вік').mean(numeric_only=True).round(2)
        print("\nСередні показники, згруповані за віком:")
        print(grouped_data)
    else:
        print(">-[УВАГА] - У датафреймі відсутній стовпець щодо віку учнів!")
"""
Функція group_by_age(df) групує дані з датафрейму за стовпцем 'Вік' та виводить середні показники за кожним віком учнів.
Аргументом функції виступає датафрейм.
"""

def aggregation(df_arg):
    if 'Вік' in df_arg.columns:
        stats_by_age = df_arg.groupby('Вік')['Ріст (см)'].agg(['mean', 'min', 'max']).round(2)
        print("\nРозширена статистика росту за віком:")
        print(stats_by_age)
    else:
        print(">-[УВАГА] - У датафреймі відсутній стовпець щодо віку учнів!")
"""
Функція agregat(df) виконує додаткові операції агрегації, 
а саме групує дані за стовпцем 'Вік' та застосовує операції знаходження середнього, мінімального, найбільшого значень до стовпця 'Ріст'.
Аргументом функція приймає датафрейм. 
"""

def main():
    df_student = create_df(student_dict)
    while True:
        print("\n~~ГОЛОВНЕ МЕНЮ:~~\n>1< - Вивести на екран оригінальний словник\n>2< - Редагування (додати вагу/вік/ІМТ)\n>3< - Аналіз даних (describe)\n>4< - Застосувати фільтр щодо росту учнів\n>5< - Сортування за ростом\n>6< - Групування за віком (середнє)\n>7< - Агрегація статистики за віком\n>0< - Вихід з програми")
        try:
            choose = input("Введіть ваш вибір: ")
        except ValueError:
            print(">-[УВАГА] - Введіть коректне число!")
            continue
        if choose == '1':
            print_start_dict(student_dict)
        elif choose == '2':
            df_student = input_df(df_student)
        elif choose == '3':
            analize_df(df_student)
        elif choose == '4':
            highly(df_student)
        elif choose == '5':
            sort(df_student)
        elif choose == '6':
            group_by_age(df_student)
        elif choose == '7':
            aggregation(df_student)
        elif choose == '0':
            print("\n>-Роботу завершено...")
            break
        else:
            print(">-[УВАГА] - Неправильний вибір, спробуйте ще раз!")
"""
Функція main() - головна функція програми, у ній використовуються всі функції та ведеться діалог з користувачем.
"""

# Запуск програми
main()